<?xml version="1.0" encoding="utf-8"?>
<mx:Application
	xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:zx="http://www.joshtynjala.com/2006/mxml"
	layout="vertical" horizontalAlign="center" creationComplete="expandTreeItems()">
	
	<mx:HBox width="640" height="480">
	
		<mx:Tree id="tree" width="100%" height="100%"
			selectable="false"
			dataProvider="{sampleData}"
			labelField="@name"/>
			
		<zx:TreeMap id="map" width="100%" height="100%"
			styleName="TopLevel"
			dataProvider="{sampleData}"
			labelField="@name"
			weightFunction="{getItemWeight}"/>
			
	</mx:HBox>
	
	<mx:XMLList id="sampleData" xmlns="">
		<branch name="Nintendo">
			<branch name="Consoles">
				<leaf name="GameCube" value="1"/>
				<leaf name="Wii" value="1"/>
			</branch>
			<branch name="Handheld">
				<leaf name="Game Boy Advance" value="1"/>
				<leaf name="Nintendo DS" value="1"/>
			</branch>
		</branch>
		<branch name="Sony">
			<branch name="Consoles">
				<leaf name="PlayStation 2" value="1"/>
				<leaf name="PlayStation 3" value="1"/>
			</branch>
			<branch name="Handheld">
				<leaf name="PSP" value="1"/>
			</branch>
		</branch>
		<branch name="Microsoft">
			<leaf name="XBOX" value="1"/>
			<leaf name="XBOX 360" value="1"/>
		</branch>
	</mx:XMLList>
	
	<mx:Style source="treemap.css"/>
	<mx:Style>
		.TopLevel
		{
			paddingLeft: 0;
			paddingRight: 0;
			paddingTop: 0;
			paddingBottom: 0;
		}
		
		TreeMap
		{
			paddingLeft: 2;
			paddingRight: 2;
			paddingTop: 2;
			paddingBottom: 2;
		}
		
		TreeMapNodeRenderer
		{
			focusAlpha: 0;
		}
	</mx:Style>
	
	<mx:Script>
		<![CDATA[
			
			private function expandTreeItems():void
			{
				for(var i:int = 0; i < sampleData.length(); i++)
				{
					var item:Object = sampleData[i];
					if(this.tree.dataDescriptor.isBranch(item))
					{
						this.tree.expandChildrenOf(item, true);
					}
				}
			}
			
			private function getItemWeight(item:Object):Number
			{
				var weight:Number = 0;
				
				if(this.map.dataDescriptor.isBranch(item))
				{
					var elements:XMLList = item.elements();
					for(var i:int = 0; i < elements.length(); i++)
					{
						var temp:Number = this.getItemWeight(elements[i]);
						weight += temp;
					}
				}
				else
				{
					weight = item.@value;
				}
				return weight;
			}
		]]>
	</mx:Script>
</mx:Application>